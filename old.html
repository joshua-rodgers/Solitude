<html>
    <head>
        <style>
            .container {
                border: 1px solid black;
                padding: 20px;
                
            }
            
            .foundation {
                display: inline-block;
                width: 7%;
                font-size: .5em;
                background-color: darkgreen;
            }
            
            #playarea {
                width: 80%;
                margin: 0 auto;
                text-align: center;
                background-color: green;
            }
            
            #pile {
                display: inline-block;
                width: 80px;
                background-color: darkgreen;
                font-size: .5em;
            }
            
            #pile-top {
                display: inline-block;
                width: 5%;
                margin-right: 30px;
                font-size: .5em;
            }
            
            #table-box {
                display: grid;
                grid-template-columns: repeat(7, 13.4%);
                grid-column-gap: 1%;
                margin-top: 10%;
            }
        </style>
    </head>
    <body>
        <!--♣︎♥︎♦︎♠︎♤♧♡♢-->
        <div class="container" id="playarea">
            <h1 class="label">Play Area</h1>
            <div class="container" id="pile">
                <h1 class="label">Pile</h1>
            </div>
            <div class="container" id="pile-top">
                <h1 class="label">Avail.</h1>
            </div>
            <div class="container foundation" id="foundation-1">
                <h1 class="label">Found</h1>
            </div>
            <div class="container foundation" id="foundation-2">
                <h1 class="label">Found</h1>
            </div>
            <div class="container foundation" id="foundation-3">
                <h1 class="label">Found</h1>
            </div>
            <div class="container foundation" id="foundation-4">
                <h1 class="label">Found</h1>
            </div>
            <div class="container" id="table-box">
                
            </div>
        </div>
        <script>
            /*----------------------------------------------
            ************************************************
            ************************************************
            GLOBALS
            ************************************************
            ************************************************
            */
            var cards = create_deck();
            var tableau = create_tableau();
            var stock_pile = deal_cards();
            var stock_pile_avail;
            var data_f1 = new Array(13);
            var data_f2 = new Array(13);
            var data_f3 = new Array(13);
            var data_f4 = new Array(13);
            var dd = new Data_Display();
            /*----------------------------------------------
            ************************************************
            ************************************************
            END GLOBALS
            ************************************************
            ************************************************
            */
            
            //==================================================================
            // INIT DISPLAY
            dd.refresh();
            //==================================================================
            
            /*----------------------------------------------
            ************************************************
            ************************************************
                CARD CLASS - card object defined here
            ************************************************
            ************************************************
            */
            function Card(suit, value, suit_color){
                this.suit = suit;
                this.value = value;
                this.is_face_up = false;
                this.suit_color = suit_color;
            }
            /*----------------------------------------------
            ************************************************
            ************************************************
            END CARD CLASS
            ************************************************
            ************************************************
            */
            //==================================================================
            /*----------------------------------------------
            ************************************************
            ************************************************
                DISPLAY CLASS - handle display concerns here
            ************************************************
            ************************************************
            */
            function Data_Display() {
                var model_col = document.createElement("div");
                model_col.className = "tableau-col container";
                
                var table_box = document.getElementById("table-box");
                var pile_top = document.getElementById("pile-top");
                var f1 = document.getElementById("foundation-1");
                var f2 = document.getElementById("foundation-2");
                var f3 = document.getElementById("foundation-3");
                var f4 = document.getElementById("foundation-4");
                
                var tableau_display = Array(7);
                
                for(var col of tableau_display.keys()){
                    tableau_display[col] = model_col.cloneNode();
                }
                
                var new_space = document.createElement("p");
                new_space.className = "space";
                
                for(var col of tableau_display){
                    for(var j = 0; j < 19; j++){
                        col.appendChild(new_space.cloneNode());
                    }
                    table_box.appendChild(col)
                }
                
                this.refresh = function(){
                    var i = 0;
                    var j = 0;
                    var display_col;
                    
                    for(var data_col of tableau){
                        display_col = tableau_display[i];
                        
                        for(var data_card of data_col){
                            if(data_card != undefined){
                                if(data_card.is_face_up){
                                    display_col.childNodes[j].innerText = data_card.suit + " " + data_card.value;
                                    display_col.childNodes[j].style.color = data_card.suit_color;
                                }else {
                                    display_col.childNodes[j].innerText = "*";
                                }
                                
                            }
                            
                            // test console.log(data_card.value);
                            j++;
                        }
                        j = 0;
                        i++;
                    }
                }
            }
            /*----------------------------------------------
            ************************************************
            ************************************************
            END DISPLAY CLASS
            ************************************************
            ************************************************
            */
            //==================================================================
            /*----------------------------------------------
            ************************************************
            ************************************************
            UTILITY FUNCTIONS - these initialize game
            ************************************************
            ************************************************
            */
            //==================================================================
            function deal_cards(){
                var column = 0;
                var card_cursor = 51;
                var local_i = 0;
                var pile = new Array(24);
                
                for(; column < 7; column++){
                    local_i = 0
                    while(local_i <= column){
                        tableau[column][local_i] = cards[card_cursor];
                        cards[card_cursor] = null;
                        if(local_i == column){
                            tableau[column][local_i].is_face_up = true;
                        }
                        card_cursor--;
                        local_i++;
                    }
                }
                for(; card_cursor >= 0; card_cursor-- ){
                    pile[card_cursor] = cards[card_cursor];
                }
                cards = [];
                return pile;
            }
            //==================================================================
            function create_deck(){
                var deck = new Array(52)
                var deck_cursor = 0;
                var suit_count = 1;
                var value = "";
                // ♣︎♥︎♦︎♠︎♤♧♡♢
                for(; suit_count <= 4; suit_count++){
                    switch(suit_count) {
                        case 1:
                            // hearts
                            generate_suit("♥︎", "red");
                            break;
                        case 2: 
                            // diamonds
                            generate_suit("♦︎", "red");
                            break;
                        case 3: 
                            // clubs
                            generate_suit("♣︎", "black");
                            break;
                        case 4:
                            // spades
                            generate_suit("♠︎", "black");
                            break;
                    }
                }
                
                return shuffle_deck(deck);
                
                //------------INNER FUNCTION OF CREATE_DECK----------------------
                function generate_suit(suit, color){
                    var face_counter = 14;
                    for(;face_counter >= 2; face_counter--){
                        switch(face_counter) {
                            case 14:
                                // ace
                                value = "A";
                                deck[deck_cursor] = new Card(suit, value, color);
                                deck_cursor++;
                                break;
                            case 13:
                                // king
                                value = "K";
                                deck[deck_cursor] = new Card(suit, value, color);
                                deck_cursor++;
                                break;
                            case 12:
                                // queen
                                value = "Q";
                                deck[deck_cursor] = new Card(suit, value, color);
                                deck_cursor++;
                                break;
                            case 11:
                                // jack
                                value = "J";
                                deck[deck_cursor] = new Card(suit, value, color);
                                deck_cursor++;
                                break;
                            default:
                                for(; face_counter >=2; face_counter--){
                                    deck[deck_cursor] = new Card(suit, face_counter, color);
                                    deck_cursor++;
                                }     
                        }
                    }
                    
                } //--------------END GENERATE_SUIT----------------
            }
            //==================================================================
            function shuffle_deck(deck){
                // refactor to keep track of open indices
                // using only open spaces.
                
                var temp_arr = new Array(52);
                var slot = 0;
                // test var counter = 0;
                
                for(var i = 0; i < 52; i++){
                    slot = generate_random();
                    temp_arr[check_slot()] = deck[i];
                }
                
                // test console.log(temp_arr);
                // test console.log(counter);
                return temp_arr;
                
                function generate_random(){
                    return Math.floor(Math.random() * 52);
                }
                
                function check_slot(){
                    var control = true;
                    var round_trip = false;
                    var origin = slot;
                    
                    if(temp_arr[slot] == null){
                        return slot;
                    }else{
                        while(control){
                            if(slot < 51 && !round_trip){
                                slot++;
                                if(temp_arr[slot] == null){
                                    control = false;
                                }
                            }else{
                                if(!round_trip){
                                    slot = origin;
                                    round_trip = true;
                                }
                                
                                slot--;
                                if(temp_arr[slot] == null){
                                    control = false;
                                }
                                // test counter++;
                            }
                        }
                        return slot;
                    }
                }
            }
            //==================================================================
            /*----------------------------------------------
            ************************************************
            ************************************************
            END UTILITY FUNCTIONS 
            ************************************************
            ************************************************
            */
            //==================================================================
            function create_tableau(){
                var table = new Array(7);
                for(var i = 0; i < table.length; i++){
                    table[i] = new Array(19);
                }
                return table;
            }
            
        </script>
    </body>
</html>